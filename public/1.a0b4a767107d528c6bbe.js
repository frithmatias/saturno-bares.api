(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{wDwh:function(e,i,t){"use strict";t.d(i,"a",function(){return L});var n=t("mrSG"),o=t("8Y7J");class a{constructor(e){this.archivo=e,this.nombreArchivo=e.name,this.estaSubiendo=!1,this.progreso=0}}var s=t("cxbk"),r=t("IheW");let c=(()=>{class e{constructor(e){this.http=e}subirImagen(e,i,t,n){const o=s.a.url+"/uploads/"+e+"/"+i,a=new FormData;return a.append("imagen",t.archivo,t.archivo.name),a.append("filesLength",n.toString()),this.http.put(o,a,{reportProgress:!0})}borrarImagen(e,i,t){return this.http.delete(s.a.url+"/uploads/"+e+"/"+i+"/"+t,{reportProgress:!0})}syncHostinger(e,i){return this.http.post(s.a.url+"/uploads/synchostinger",{idDocument:e,idField:i})}}return e.\u0275fac=function(i){return new(i||e)(o.Xb(r.b))},e.\u0275prov=o.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var l=t("zHaW"),d=t("SVse"),u=t("PDjf");let b=(()=>{class e{constructor(){this.mouseSobre=new o.o,this.sendDropFiles=new o.o}onDragEnter(e){e.preventDefault(),e.stopPropagation(),this.mouseSobre.emit(!0),this.sendDropFiles.emit(e)}onDragLeave(e){this.mouseSobre.emit(!1)}onDrop(e){this.sendDropFiles.emit(e),this.mouseSobre.emit(!1)}}return e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=o.Ib({type:e,selectors:[["","app-dropfiles",""]],hostBindings:function(e,i){1&e&&o.ac("dragover",function(e){return i.onDragEnter(e)})("dragleave",function(e){return i.onDragLeave(e)})("drop",function(e){return i.onDrop(e)})},outputs:{mouseSobre:"mouseSobre",sendDropFiles:"sendDropFiles"}}),e})();var p=t("Dxy4"),f=t("0CBe");let g=(()=>{class e{transform(e,i){let t;return t=e.length>i?e.substr(0,i)+"...":e,t}}return e.\u0275fac=function(i){return new(i||e)},e.\u0275pipe=o.Mb({name:"wordMaxLength",type:e,pure:!0}),e})();const m=["fileInput"];function h(e,i){if(1&e&&(o.Tb(0,"mat-card-header"),o.Tb(1,"mat-card-title"),o.Ob(2,"span"),o.Hc(3),o.Sb(),o.Tb(4,"mat-card-subtitle"),o.Hc(5),o.Sb(),o.Sb()),2&e){const e=o.ec();o.Bb(2),o.Db(e.header.icon),o.Bb(1),o.Jc(" ",e.header.title," "),o.Bb(2),o.Ic(e.header.subtitle)}}function v(e,i){if(1&e){const e=o.Ub();o.Tb(0,"span",12),o.ac("click",function(){o.wc(e);const i=o.ec(4);return i.deleteImage(i.data[i.idField])}),o.Sb()}}function S(e,i){if(1&e&&(o.Tb(0,"div",9),o.Ob(1,"img",10),o.fc(2,"imagenPipe"),o.Fc(3,v,1,0,"span",11),o.Sb()),2&e){const e=o.ec(3);o.Bb(1),o.mc("src",o.ic(2,2,e.data[e.idField],e.idField,e.idDocument),o.yc),o.Bb(2),o.lc("ngIf",e.editable)}}function F(e,i){if(1&e&&(o.Tb(0,"label",15),o.Ob(1,"img",16),o.Sb()),2&e){const e=o.ec(4);o.lc("for",e.idField)}}function T(e,i){1&e&&(o.Tb(0,"label",9),o.Ob(1,"img",16),o.Sb())}function x(e,i){if(1&e&&(o.Tb(0,"div"),o.Fc(1,F,2,1,"label",13),o.Fc(2,T,2,0,"ng-template",null,14,o.Gc),o.Sb()),2&e){const e=o.tc(3),i=o.ec(3);o.Bb(1),o.lc("ngIf",i.editable)("ngIfElse",e)}}function I(e,i){if(1&e){const e=o.Ub();o.Tb(0,"span",12),o.ac("click",function(){o.wc(e);const i=o.ec(4);return i.removeQueue(i.filesToUpload[0].nombreArchivo)}),o.Sb()}}function O(e,i){if(1&e&&(o.Tb(0,"div",9),o.Ob(1,"img",17),o.Fc(2,I,1,0,"span",11),o.Sb()),2&e){const e=o.ec(3);o.Bb(1),o.lc("src",e.filesToUpload[0].bufferImage,o.yc),o.Bb(1),o.lc("ngIf",e.editable)}}function w(e,i){if(1&e&&(o.Tb(0,"div",7),o.Fc(1,S,4,6,"div",8),o.Fc(2,x,4,2,"div",0),o.Fc(3,O,3,2,"div",8),o.Sb()),2&e){const e=o.ec(2);o.Bb(1),o.lc("ngIf",0===e.filesToUpload.length&&e.data[e.idField]),o.Bb(1),o.lc("ngIf",0===e.filesToUpload.length&&!e.data[e.idField]),o.Bb(1),o.lc("ngIf",e.filesToUpload&&e.filesToUpload.length>0)}}function B(e,i){if(1&e){const e=o.Ub();o.Tb(0,"div",9),o.Ob(1,"img",10),o.fc(2,"imagenPipe"),o.Tb(3,"span",12),o.ac("click",function(){o.wc(e);const t=i.$implicit;return o.ec(3).deleteImage(t)}),o.Sb(),o.Sb()}if(2&e){const e=i.$implicit,t=o.ec(3);o.Bb(1),o.mc("src",o.ic(2,1,e,t.idField,t.idDocument),o.yc)}}function U(e,i){if(1&e){const e=o.Ub();o.Tb(0,"div",9),o.Ob(1,"img",17),o.Tb(2,"span",12),o.ac("click",function(){o.wc(e);const t=i.$implicit;return o.ec(3).removeQueue(t.nombreArchivo)}),o.Sb(),o.Sb()}if(2&e){const e=i.$implicit;o.Bb(1),o.lc("src",e.bufferImage,o.yc)}}function D(e,i){if(1&e&&(o.Tb(0,"div",20),o.Tb(1,"label",21),o.Ob(2,"img",16),o.Sb(),o.Sb()),2&e){const e=o.ec(3);o.Bb(1),o.lc("for",e.idField)}}const _=function(){return[]};function k(e,i){if(1&e&&(o.Tb(0,"div",7),o.Fc(1,B,4,5,"div",18),o.Fc(2,U,3,1,"div",18),o.Fc(3,D,3,1,"div",19),o.Sb()),2&e){const e=o.ec(2);o.Bb(1),o.lc("ngForOf",e.data[e.idField]),o.Bb(1),o.lc("ngForOf",e.filesToUpload),o.Bb(1),o.lc("ngForOf",o.oc(3,_).constructor(e.maxupload-e.data[e.idField].length-e.filesToUpload.length))}}function y(e,i){if(1&e&&(o.Tb(0,"div"),o.Fc(1,w,4,3,"div",6),o.Fc(2,k,4,4,"div",6),o.Sb()),2&e){const e=o.ec();o.Bb(1),o.lc("ngIf",!e.multi),o.Bb(1),o.lc("ngIf",e.multi)}}function P(e,i){1&e&&(o.Tb(0,"div"),o.Hc(1,"Arrastre aqu\xed las imagenes"),o.Sb())}const C=function(e){return{"text-green":e}},M=function(e){return{width:e}};function E(e,i){if(1&e&&(o.Tb(0,"div"),o.Tb(1,"div",22),o.Hc(2),o.fc(3,"wordMaxLength"),o.fc(4,"number"),o.Sb(),o.Tb(5,"div",23),o.Ob(6,"div",24),o.Sb(),o.Sb()),2&e){const e=i.$implicit;o.Bb(1),o.lc("ngClass",o.pc(11,C,e.progreso>=100)),o.Bb(1),o.Lc(" ",o.hc(3,5,e.nombreArchivo,10)," ",o.hc(4,8,e.archivo.size/1024,".2-2")," KB (Subido: ",e.progreso,"%) "),o.Bb(4),o.lc("ngStyle",o.pc(13,M,e.progreso+"%"))}}function z(e,i){if(1&e){const e=o.Ub();o.Tb(0,"mat-card-actions"),o.Tb(1,"button",25),o.ac("click",function(){return o.wc(e),o.ec().uploadMulti()}),o.Ob(2,"i",26),o.Hc(3," Subir"),o.Sb(),o.Tb(4,"button",25),o.ac("click",function(){return o.wc(e),o.ec().deleteImage("todas")}),o.Ob(5,"i",27),o.Hc(6," Eliminar Todas"),o.Sb(),o.Sb()}if(2&e){const e=o.ec();o.Bb(1),o.lc("disabled",0===e.filesToUpload.length),o.Bb(3),o.lc("disabled",0===e.data[e.idField].length)}}function A(e,i){if(1&e){const e=o.Ub();o.Tb(0,"div"),o.Tb(1,"button",25),o.ac("click",function(){return o.wc(e),o.ec().uploadSingle()}),o.Ob(2,"i",26),o.Hc(3," Subir"),o.Sb(),o.Sb()}if(2&e){const e=o.ec();o.Bb(1),o.lc("disabled",0==e.filesToUpload.length)}}const H=function(e){return{"file-over":e}};let L=(()=>{class e{constructor(e,i){this.uploaderService=e,this.snack=i,this.editable=!0,this.multi=!1,this.dataUpdated=new o.o,this.filesToUpload=[],this.maxupload=12,this.maxSize=102400,this.estaSobreElemento=!1}ngOnInit(){return Object(n.a)(this,void 0,void 0,function*(){this.data?(this.fileInput.nativeElement.multiple=this.multi,this.maxupload=this.multi?this.maxupload:1):this.snack.open("Sin datos en el componente uploader",null,{duration:3e3})})}uploadSingle(){this.fileInput.nativeElement.value="";let e=this.filesToUpload[0];this.uploaderService.subirImagen(this.idDocument,this.idField,e,1).subscribe(i=>{e.progreso=100,e.estaSubiendo=!1,this.data[this.idField]=i.filename,this.filesToUpload=[],this.dataUpdated.emit(this.data)})}uploadMulti(){this.fileInput.nativeElement.value="";let e=this.filesToUpload.length;this.filesToUpload.forEach((i,t,n)=>{i.estaSubiendo=!0,this.uploaderService.subirImagen(this.idDocument,this.idField,i,n.length).subscribe(n=>{i.progreso=100,i.estaSubiendo=!1,this.data[this.idField].push(n.filename),this.filesToUpload=this.filesToUpload.filter(e=>e.nombreArchivo!==i.nombreArchivo),t===e-1&&(this.dataUpdated.emit(this.data),this.uploaderService.syncHostinger(this.idDocument,this.idField).subscribe(e=>{e.ok&&this.snack.open(e.msg,null,{duration:2e3})}))},()=>{this.filesToUpload=this.filesToUpload.filter(e=>e.nombreArchivo!==i.nombreArchivo)})})}deleteImage(e){this.snack.open("Desea borrar esta imagen?","Si borrar",{duration:5e3}).afterDismissed().subscribe(i=>{i.dismissedByAction&&this.uploaderService.borrarImagen(this.idDocument,this.idField,e).subscribe(e=>{this.data[this.idField]=this.multi?"todas"===e.filename?[]:this.data[this.idField].filter(i=>i!=e.filename):null,this.uploaderService.syncHostinger(this.idDocument,this.idField).subscribe(e=>{e.ok&&this.snack.open(e.msg,null,{duration:2e3})}),this.dataUpdated.emit(this.data)})})}removeQueue(e){this.filesToUpload=this.filesToUpload.filter(i=>i.nombreArchivo!==e),this.fileInput.nativeElement.value=""}queueFiles(e){let i=e.target.files||e.dataTransfer.files;this.multi&&this.maxupload-this.data.length-this.filesToUpload.length-i.length<0?this.snack.open(`Supera el m\xe1ximo permitido de ${this.maxupload} im\xe1genes`,null,{duration:3e3}):(this._extractFiles(i),this._stopPrevent(e))}_getTransfer(e){return e.dataTransfer.files?e.dataTransfer.files:e.originalEvent.dataTransfer.files}_extractFiles(e){for(const i in Object.getOwnPropertyNames(e)){const t=e[i];if(this._fileCanLoaded(t)){const e=new a(t),i=new FileReader;i.readAsDataURL(t),i.onloadend=()=>e.bufferImage=i.result,this.filesToUpload.push(e)}}}_fileCanLoaded(e){return!(this._fileWasDropped(e.name)||!this._isImage(e.type)||!this._sizeOk(e.size))}_stopPrevent(e){e.preventDefault(),e.stopPropagation()}_fileWasDropped(e){return!1}_isImage(e){return!(""===e||void 0===e||!["image/png","image/jpg","image/gif","image/jpeg"].includes(e))||(this.snack.open("No es un tipo de archivo de imagen permitido.",null,{duration:3e3}),!1)}_sizeOk(e){return!(e>this.maxSize&&(this.snack.open(`El archivo supera el tama\xf1o m\xe1ximo permitido de ${this.maxSize/1024} kb`,null,{duration:3e3}),1))}}return e.\u0275fac=function(i){return new(i||e)(o.Nb(c),o.Nb(l.a))},e.\u0275cmp=o.Hb({type:e,selectors:[["app-uploader"]],viewQuery:function(e,i){if(1&e&&o.Bc(m,!0),2&e){let e;o.sc(e=o.bc())&&(i.fileInput=e.first)}},inputs:{editable:"editable",multi:"multi",data:"data",idDocument:"idDocument",idField:"idField",header:"header"},outputs:{dataUpdated:"dataUpdated"},decls:11,vars:10,consts:[[4,"ngIf"],[1,"my-0"],["app-dropfiles","",1,"container","p-2","drop-zone","file-over",3,"ngClass","mouseSobre","sendDropFiles"],["type","file",2,"display","none",3,"id","change"],["fileInput",""],[4,"ngFor","ngForOf"],["class","images-container",4,"ngIf"],[1,"images-container"],["class","image",4,"ngIf"],[1,"image"],[3,"src"],["class","mdi mdi-close delete-icon",3,"click",4,"ngIf"],[1,"mdi","mdi-close","delete-icon",3,"click"],["class","image pointer",3,"for",4,"ngIf","ngIfElse"],["noimage",""],[1,"image","pointer",3,"for"],["src","../../../assets/img/no-image1.png"],[1,"image-queue",3,"src"],["class","image",4,"ngFor","ngForOf"],["class","image pointer",4,"ngFor","ngForOf"],[1,"image","pointer"],[2,"cursor","inherit",3,"for"],[1,"text-upload","text-left",3,"ngClass"],[1,"progress"],["role","progressbar","aria-valuenow","25","aria-valuemin","0","aria-valuemax","100",1,"progress-bar",2,"width","25%",3,"ngStyle"],["mat-button","",3,"disabled","click"],[1,"mdi","mdi-upload"],[1,"mdi","mdi-delete"]],template:function(e,i){1&e&&(o.Fc(0,h,6,4,"mat-card-header",0),o.Tb(1,"mat-card-content",1),o.Tb(2,"div",2),o.ac("mouseSobre",function(e){return i.estaSobreElemento=e})("sendDropFiles",function(e){return i.queueFiles(e)}),o.Tb(3,"input",3,4),o.ac("change",function(e){return i.queueFiles(e)}),o.Sb(),o.Fc(5,y,3,2,"div",0),o.Tb(6,"div"),o.Fc(7,P,2,0,"div",0),o.Fc(8,E,7,15,"div",5),o.Sb(),o.Sb(),o.Sb(),o.Fc(9,z,7,2,"mat-card-actions",0),o.Fc(10,A,4,1,"div",0)),2&e&&(o.lc("ngIf",i.header),o.Bb(2),o.lc("ngClass",o.pc(8,H,i.estaSobreElemento)),o.Bb(1),o.lc("id",i.idField),o.Bb(2),o.lc("ngIf",i.data),o.Bb(2),o.lc("ngIf",i.multi),o.Bb(1),o.lc("ngForOf",i.filesToUpload),o.Bb(1),o.lc("ngIf",i.multi),o.Bb(1),o.lc("ngIf",!i.multi&&i.editable))},directives:[d.k,u.d,b,d.i,d.j,u.e,u.h,u.g,d.l,u.b,p.a],pipes:[f.a,g,d.d],styles:[".drop-zone[_ngcontent-%COMP%]{border:1px dotted grey;color:#666;text-align:center;vertical-align:top}.file-over[_ngcontent-%COMP%]{border:1px dotted #1e90ff}.text-upload[_ngcontent-%COMP%]{font-size:small;font-family:monospace}.text-green[_ngcontent-%COMP%]{color:#139913}.slider_imgs[_ngcontent-%COMP%]{height:70px;width:70px}.image[_ngcontent-%COMP%]:hover{border:1px solid hsla(0,0%,39.2%,.5)}.image[_ngcontent-%COMP%]   .delete-icon[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:0;color:#fff;font-weight:200;right:3px;text-shadow:-1px 0 #000,0 1px #000,0 -1px #000,1px 0 #000}.table-upload[_ngcontent-%COMP%]{font-size:12px;text-align:left;vertical-align:top;margin:0;padding:0;width:100%}.progress[_ngcontent-%COMP%]{display:flex;height:.2rem;overflow:hidden;line-height:0;font-size:.75rem;background-color:#5d5d5d}.image-queue[_ngcontent-%COMP%]{opacity:.3}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.images-container[_ngcontent-%COMP%]{display:flex;flex-grow:1;flex-shrink:1;flex-basis:auto;flex-wrap:wrap;justify-content:center}.image-logo[_ngcontent-%COMP%]{margin:5px;width:8em;height:8em}.image[_ngcontent-%COMP%], .image-logo[_ngcontent-%COMP%]{position:relative;display:flex}.image[_ngcontent-%COMP%]{margin:1px;width:5em;height:5em}.image[_ngcontent-%COMP%]:hover{border:none}"]}),e})()}}]);